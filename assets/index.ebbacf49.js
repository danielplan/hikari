var L=Object.defineProperty;var f=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var w=(e,t,r)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,p=(e,t)=>{for(var r in t||(t={}))I.call(t,r)&&w(e,r,t[r]);if(f)for(var r of f(t))k.call(t,r)&&w(e,r,t[r]);return e};const A=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}};A();function v(e,t,r){const o=document.createElement("label");o.innerText=e,o.htmlFor=e;const n=document.createElement("input");n.value=t,n.name=e;const a=document.createElement("div");return a.classList.add("control-item"),a.appendChild(o),a.appendChild(n),r.appendChild(a),{controlParent:a,controlElement:n}}function s(e,t,r,o,n){const{controlElement:a,controlParent:i}=v(r,o.toString(),n);return a.type="range",a.min=e.toString(),a.max=t.toString(),a.classList.add("range-element"),i.appendChild(O(a)),a}function S(e,t){const{controlElement:r}=v(e,"1",t);return r.type="checkbox",r.classList.add("checkbox-element"),r}function O(e){const t=document.createElement("input");return t.classList.add("number-element"),t.min=e.min,t.max=e.max,t.type="number",t.value=e.value,e.addEventListener("input",()=>{t.value=e.value}),t.addEventListener("change",()=>{e.value=t.value,e.dispatchEvent(new InputEvent("change"))}),t}function b(e,t,r,o,n,a){const i=new Uint8Array(Object.values(o).map(c=>c.checked?1:0)),u=new Uint8Array(Object.values(n).map(c=>Number.parseInt(c.value)+100)),l=t.getImageData(0,0,e.width,e.height);a.postMessage({settingsValues:i,controlValues:u,imageData:l}),a.onmessage=c=>{const m=c.data;r.putImageData(m,0,0)}}function R(e,t,r,o){const n=document.createElement("canvas"),a=e.width,i=e.height;let u=0,l=0,c=1920;a>i?(c=Math.min(c,a),u=c,l=i*c/a):(c=Math.min(c,i),l=c,u=a*c/i),n.width=u,n.height=l;const m=n.getContext("2d");m.drawImage(e,0,0,u,l),b(n,m,m,t,r,o),o.onmessage=()=>j(n)}function j(e){const t=e.toDataURL("image/jpg"),r=document.createElement("a");r.download="hikari-export.jpg",r.href=t,r.click(),r.remove()}function C(){return new Worker("/hikari/assets/renderWorker.bc2beee3.js",{type:"module"})}const d=document.createElement("canvas"),h=document.createElement("canvas"),y=d.getContext("2d"),E=h.getContext("2d");async function D(e,t){if(t&&t[0]){e.innerHTML="";const r=t[0],o=await W(r);e.appendChild(d);const n=new Image;n.src=o.toString(),n.onload=()=>{const a=B(n.width,n.height);d.setAttribute("width",a.width.toString()),d.setAttribute("height",a.height.toString()),y.drawImage(n,0,0,d.width,d.height),h.setAttribute("width",a.width.toString()),h.setAttribute("height",a.height.toString()),E.drawImage(n,0,0,h.width,h.height),P(e,n)}}}function M(e,t,r,o,n){const a=document.createElement("button");a.textContent="Export",a.onclick=()=>R(t,r,o,n),e.appendChild(a)}function P(e,t){const r={invert:S("Invert",e),bw:S("Black & White",e)},o={brightness:s(-100,100,"Brightness",0,e),contrast:s(-100,100,"Contrast",0,e),saturation:s(-100,100,"Saturation",0,e),redSaturation:s(-100,100,"Red Saturation",0,e),orangeSaturation:s(-100,100,"Orange Saturation",0,e),yellowSaturation:s(-100,100,"Yellow Saturation",0,e),greenSaturation:s(-100,100,"Green Saturation",0,e),tealSaturation:s(-100,100,"Teal Saturation",0,e),cyanSaturation:s(-100,100,"Cyan Saturation",0,e),blueSaturation:s(-100,100,"Blue Saturation",0,e),purpleSaturation:s(-100,100,"Purple Saturation",0,e),magentaSaturation:s(-100,100,"Magenta Saturation",0,e)},n=new C,a=new C,i=p(p({},r),o);M(e,t,r,o,a),Object.values(i).forEach(u=>u.addEventListener("change",()=>b(h,E,y,r,o,n)))}function W(e){return new Promise((t,r)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result?o.result.toString():""),o.onerror=n=>r(n)})}function B(e,t){const r=window.innerHeight*.5,o=window.innerWidth*.5;let n;return e>t?n={width:o,height:o*t/e}:n={width:r*e/t,height:r},n}const x=document.querySelector("#app"),g=document.createElement("input");g.setAttribute("type","file");x.appendChild(g);g.addEventListener("change",()=>{D(x,g.files)});
