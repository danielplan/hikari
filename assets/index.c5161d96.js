var I=Object.defineProperty;var w=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var v=(t,n,r)=>n in t?I(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,f=(t,n)=>{for(var r in n||(n={}))k.call(n,r)&&v(t,r,n[r]);if(w)for(var r of w(n))A.call(n,r)&&v(t,r,n[r]);return t};const O=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(e){if(e.ep)return;e.ep=!0;const a=r(e);fetch(e.href,a)}};O();function S(t,n,r){const o=document.createElement("label");o.innerText=t,o.htmlFor=t;const e=document.createElement("input");e.value=n,e.name=t;const a=document.createElement("div");return a.classList.add("control-item"),a.appendChild(o),a.appendChild(e),r.appendChild(a),{controlParent:a,controlElement:e}}function s(t,n,r,o,e){const{controlElement:a,controlParent:i}=S(r,o.toString(),e);return a.type="range",a.min=t.toString(),a.max=n.toString(),a.classList.add("range-element"),i.appendChild(R(a)),a}function C(t,n){const{controlElement:r}=S(t,"1",n);return r.type="checkbox",r.classList.add("checkbox-element"),r}function R(t){const n=document.createElement("input");return n.classList.add("number-element"),n.min=t.min,n.max=t.max,n.type="number",n.value=t.value,t.addEventListener("input",()=>{n.value=t.value}),n.addEventListener("change",()=>{t.value=n.value,t.dispatchEvent(new InputEvent("change"))}),n}function b(t,n,r,o,e,a){const i=new Uint8Array(Object.values(o).map(c=>c.checked?1:0)),u=new Uint8Array(Object.values(e).map(c=>Number.parseInt(c.value)+100)),l=n.getImageData(0,0,t.width,t.height);a.postMessage({settingsValues:i,controlValues:u,imageData:l}),a.onmessage=c=>{const m=c.data;r.putImageData(m,0,0)}}function j(t,n,r,o){const e=document.createElement("canvas"),a=t.width,i=t.height;let u=0,l=0,c=1920;a>i?(c=Math.min(c,a),u=c,l=i*c/a):(c=Math.min(c,i),l=c,u=a*c/i),e.width=u,e.height=l;const m=e.getContext("2d");m.drawImage(t,0,0,u,l),b(e,m,m,n,r,o),o.onmessage=()=>{const L=e.toDataURL("image/jpg"),g=document.createElement("a");g.download="hikari-export.jpg",g.href=L,g.click(),g.remove()}}function D(){return new Worker("/hikari/assets/renderWorker.31c1fc65.js",{type:"module"})}const d=document.createElement("canvas"),h=document.createElement("canvas"),y=d.getContext("2d"),E=h.getContext("2d");async function M(t,n){if(n&&n[0]){t.innerHTML="";const r=n[0],o=await B(r);t.appendChild(d);const e=new Image;e.src=o.toString(),e.onload=()=>{const a=N(e.width,e.height);d.setAttribute("width",a.width.toString()),d.setAttribute("height",a.height.toString()),y.drawImage(e,0,0,d.width,d.height),h.setAttribute("width",a.width.toString()),h.setAttribute("height",a.height.toString()),E.drawImage(e,0,0,h.width,h.height),W(t,e)}}}function P(t,n,r,o,e){const a=document.createElement("button");a.textContent="Export",a.onclick=()=>j(n,r,o,e),t.appendChild(a)}function W(t,n){const r={invert:C("Invert",t),bw:C("Black & White",t)},o={brightness:s(-100,100,"Brightness",0,t),contrast:s(-100,100,"Contrast",0,t),saturation:s(-100,100,"Saturation",0,t),redSaturation:s(-100,100,"Red Saturation",0,t),orangeSaturation:s(-100,100,"Orange Saturation",0,t),yellowSaturation:s(-100,100,"Yellow Saturation",0,t),greenSaturation:s(-100,100,"Green Saturation",0,t),tealSaturation:s(-100,100,"Teal Saturation",0,t),cyanSaturation:s(-100,100,"Cyan Saturation",0,t),blueSaturation:s(-100,100,"Blue Saturation",0,t),purpleSaturation:s(-100,100,"Purple Saturation",0,t),magentaSaturation:s(-100,100,"Magenta Saturation",0,t)},e=new D,a=f(f({},r),o);P(t,n,r,o,e),Object.values(a).forEach(i=>i.addEventListener("change",()=>b(h,E,y,r,o,e)))}function B(t){return new Promise((n,r)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=()=>n(o.result?o.result.toString():""),o.onerror=e=>r(e)})}function N(t,n){const r=window.innerHeight*.5,o=window.innerWidth*.5;let e;return t>n?e={width:o,height:o*n/t}:e={width:r*t/n,height:r},e}const x=document.querySelector("#app"),p=document.createElement("input");p.setAttribute("type","file");x.appendChild(p);p.addEventListener("change",()=>{M(x,p.files)});
