var I=Object.defineProperty;var p=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var f=(e,t,r)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))k.call(t,r)&&f(e,r,t[r]);if(p)for(var r of p(t))A.call(t,r)&&f(e,r,t[r]);return e};const D=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}};D();function v(e,t,r){const o=document.createElement("label");o.innerText=e,o.htmlFor=e;const n=document.createElement("input");n.value=t,n.name=e;const a=document.createElement("div");return a.classList.add("control-item"),a.appendChild(o),a.appendChild(n),r.appendChild(a),{controlParent:a,controlElement:n}}function s(e,t,r,o,n){const{controlElement:a,controlParent:i}=v(r,o.toString(),n);return a.type="range",a.min=e.toString(),a.max=t.toString(),a.classList.add("range-element"),i.appendChild(O(a)),a}function w(e,t){const{controlElement:r}=v(e,"1",t);return r.type="checkbox",r.classList.add("checkbox-element"),r}function O(e){const t=document.createElement("input");return t.classList.add("number-element"),t.min=e.min,t.max=e.max,t.type="number",t.value=e.value,e.addEventListener("input",()=>{t.value=e.value}),t.addEventListener("change",()=>{e.value=t.value,e.dispatchEvent(new InputEvent("change"))}),t}function S(e,t,r,o,n){const a=new Uint8Array(Object.values(r).map(l=>l.checked?1:0)),i=new Uint8Array(Object.values(o).map(l=>Number.parseInt(l.value)+100)),c=t.getImageData(0,0,e.width,e.height);n.postMessage({settingsValues:a,controlValues:i,imageData:c})}function B(e,t,r,o){const n=document.createElement("canvas"),a=e.width,i=e.height;let c=0,l=0,u=1920;a>i?(u=Math.min(u,a),c=u,l=i*u/a):(u=Math.min(u,i),l=u,c=a*u/i),n.width=c,n.height=l;const m=n.getContext("2d");m.drawImage(e,0,0,c,l),o.onmessage=x=>{const L=x.data;m.putImageData(L,0,0),R(n)},S(n,m,t,r,o)}function R(e){const t=e.toDataURL("image/jpg"),r=document.createElement("a");r.download="hikari-export.jpg",r.href=t,r.click(),r.remove()}function b(){return new Worker("/hikari/assets/renderWorker.d6196d40.js",{type:"module"})}const d=document.createElement("canvas"),h=document.createElement("canvas"),C=d.getContext("2d"),y=h.getContext("2d");async function j(e,t){if(t&&t[0]){const r=t[0],o=await W(r),n=new Image;n.src=o.toString(),n.onload=()=>{e.innerHTML="",e.appendChild(d);const a=N(n.width,n.height);d.setAttribute("width",a.width.toString()),d.setAttribute("height",a.height.toString()),C.drawImage(n,0,0,d.width,d.height),h.setAttribute("width",a.width.toString()),h.setAttribute("height",a.height.toString()),y.drawImage(n,0,0,h.width,h.height),P(e,n)},n.onerror=()=>{const a=document.getElementById("error-text");a.classList.add("visible"),setTimeout(()=>a.classList.remove("visible"),2e3)}}}function M(e,t,r,o,n){const a=document.createElement("button");a.textContent="Export",a.onclick=()=>B(t,r,o,n),e.appendChild(a)}function P(e,t){const r={invert:w("Invert",e),bw:w("Black & White",e)},o={brightness:s(-100,100,"Brightness",0,e),contrast:s(-100,100,"Contrast",0,e),saturation:s(-100,100,"Saturation",0,e),light:s(-100,100,"Light brightness",0,e),dark:s(-100,100,"Dark brightness",0,e),redSaturation:s(-100,100,"Red Saturation",0,e),orangeSaturation:s(-100,100,"Orange Saturation",0,e),yellowSaturation:s(-100,100,"Yellow Saturation",0,e),greenSaturation:s(-100,100,"Green Saturation",0,e),tealSaturation:s(-100,100,"Teal Saturation",0,e),cyanSaturation:s(-100,100,"Cyan Saturation",0,e),blueSaturation:s(-100,100,"Blue Saturation",0,e),purpleSaturation:s(-100,100,"Purple Saturation",0,e),magentaSaturation:s(-100,100,"Magenta Saturation",0,e)},n=new b;n.onmessage=c=>{const l=c.data;C.putImageData(l,0,0)};const a=new b,i=g(g({},r),o);M(e,t,r,o,a),Object.values(i).forEach(c=>c.addEventListener("change",()=>S(h,y,r,o,n)))}function W(e){return new Promise((t,r)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result?o.result.toString():""),o.onerror=n=>r(n)})}function N(e,t){const r=window.innerHeight*.5,o=window.innerWidth*.5;let n;return e>t?n={width:o,height:o*t/e}:n={width:r*e/t,height:r},n}const U=document.querySelector("#app"),E=document.getElementById("image-uploader");E.addEventListener("change",()=>{j(U,E.files)});
