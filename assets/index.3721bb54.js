var I=Object.defineProperty;var p=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var f=(e,t,r)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))k.call(t,r)&&f(e,r,t[r]);if(p)for(var r of p(t))R.call(t,r)&&f(e,r,t[r]);return e};const A=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}};A();function v(e,t,r){const o=document.createElement("label");o.innerText=e,o.htmlFor=e;const n=document.createElement("input");n.value=t,n.name=e;const a=document.createElement("div");return a.classList.add("control-item"),a.appendChild(o),a.appendChild(n),r.appendChild(a),{controlParent:a,controlElement:n}}function d(e,t,r,o,n){const{controlElement:a,controlParent:i}=v(r,o.toString(),n);return a.type="range",a.min=e.toString(),a.max=t.toString(),a.classList.add("range-element"),i.appendChild(D(a)),a}function w(e,t){const{controlElement:r}=v(e,"1",t);return r.type="checkbox",r.classList.add("checkbox-element"),r}function D(e){const t=document.createElement("input");return t.classList.add("number-element"),t.min=e.min,t.max=e.max,t.type="number",t.value=e.value,e.addEventListener("input",()=>{t.value=e.value}),t.addEventListener("change",()=>{e.value=t.value,e.dispatchEvent(new InputEvent("change"))}),t}function S(e,t,r,o,n){const a=new Uint8Array(Object.values(r).map(c=>c.checked?1:0)),i=new Uint8Array(Object.values(o).map(c=>Number.parseInt(c.value)+100)),s=t.getImageData(0,0,e.width,e.height);n.postMessage({settingsValues:a,controlValues:i,imageData:s})}function O(e,t,r,o){const n=document.createElement("canvas"),a=e.width,i=e.height;let s=0,c=0,l=1920;a>i?(l=Math.min(l,a),s=l,c=i*l/a):(l=Math.min(l,i),c=l,s=a*l/i),n.width=s,n.height=c;const h=n.getContext("2d");h.drawImage(e,0,0,s,c),o.onmessage=L=>{const x=L.data;h.putImageData(x,0,0),B(n)},S(n,h,t,r,o)}function B(e){const t=e.toDataURL("image/jpg"),r=document.createElement("a");r.download="hikari-export.jpg",r.href=t,r.click(),r.remove()}function C(){return new Worker("/hikari/assets/renderWorker.1ff1a666.js",{type:"module"})}const u=document.createElement("canvas"),m=document.createElement("canvas"),b=u.getContext("2d"),E=m.getContext("2d");async function j(e,t){if(t&&t[0]){const r=t[0],o=await W(r),n=new Image;n.src=o.toString(),n.onload=()=>{e.innerHTML="";const a=N(n.width,n.height);u.setAttribute("width",a.width.toString()),u.setAttribute("height",a.height.toString()),b.drawImage(n,0,0,u.width,u.height),m.setAttribute("width",a.width.toString()),m.setAttribute("height",a.height.toString()),E.drawImage(n,0,0,m.width,m.height);const i=document.createElement("div");i.classList.add("render-container");const s=document.createElement("div");s.classList.add("controls-container");const c=document.createElement("div");c.classList.add("canvas-container"),P(s,n),e.appendChild(i),c.appendChild(u),i.appendChild(c),i.appendChild(s)},n.onerror=()=>{const a=document.getElementById("error-text");a.classList.add("visible"),setTimeout(()=>a.classList.remove("visible"),2e3)}}}function M(e,t,r,o,n){const a=document.createElement("button");a.textContent="Export",a.onclick=()=>O(t,r,o,n),e.appendChild(a)}function P(e,t){const r={invert:w("Invert",e),bw:w("Black & White",e)},o={brightness:d(-100,100,"Brightness",0,e),contrast:d(-100,100,"Contrast",0,e),saturation:d(-100,100,"Saturation",0,e),light:d(-100,100,"Light brightness",0,e),dark:d(-100,100,"Dark brightness",0,e),redSaturation:d(-100,100,"Red Saturation",0,e),orangeSaturation:d(-100,100,"Orange Saturation",0,e),yellowSaturation:d(-100,100,"Yellow Saturation",0,e),greenSaturation:d(-100,100,"Green Saturation",0,e),tealSaturation:d(-100,100,"Teal Saturation",0,e),cyanSaturation:d(-100,100,"Cyan Saturation",0,e),blueSaturation:d(-100,100,"Blue Saturation",0,e),purpleSaturation:d(-100,100,"Purple Saturation",0,e),magentaSaturation:d(-100,100,"Magenta Saturation",0,e)},n=new C;n.onmessage=s=>{const c=s.data;b.putImageData(c,0,0)};const a=new C,i=g(g({},r),o);M(e,t,r,o,a),Object.values(i).forEach(s=>s.addEventListener("change",()=>S(m,E,r,o,n)))}function W(e){return new Promise((t,r)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result?o.result.toString():""),o.onerror=n=>r(n)})}function N(e,t){const r=window.innerHeight*.5,o=window.innerWidth*.5;let n;return e>t?n={width:o,height:o*t/e}:n={width:r*e/t,height:r},n}const U=document.querySelector("#app"),y=document.getElementById("image-uploader");y.addEventListener("change",()=>{j(U,y.files)});
