var k=Object.defineProperty;var f=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var w=(t,e,a)=>e in t?k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,p=(t,e)=>{for(var a in e||(e={}))A.call(e,a)&&w(t,a,e[a]);if(f)for(var a of f(e))O.call(e,a)&&w(t,a,e[a]);return t};const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}};D();function v(t,e,a){const o=document.createElement("label");o.innerText=t,o.htmlFor=t;const n=document.createElement("input");n.value=e,n.name=t;const r=document.createElement("div");return r.classList.add("control-item"),r.appendChild(o),r.appendChild(n),a.appendChild(r),{controlParent:r,controlElement:n}}function c(t,e,a,o,n){const{controlElement:r,controlParent:i}=v(a,o.toString(),n);return r.type="range",r.min=t.toString(),r.max=e.toString(),r.classList.add("range-element"),i.appendChild(R(r)),r}function S(t,e){const{controlElement:a}=v(t,"1",e);return a.type="checkbox",a.classList.add("checkbox-element"),a}function R(t){const e=document.createElement("input");return e.classList.add("number-element"),e.min=t.min,e.max=t.max,e.type="number",e.value=t.value,t.addEventListener("input",()=>{e.value=t.value}),e.addEventListener("change",()=>{t.value=e.value,t.dispatchEvent(new InputEvent("change"))}),e}function b(t,e,a,o,n){const r=new Uint8Array(Object.values(a).map(u=>u.checked?1:0)),i=new Uint8Array(Object.values(o).map(u=>Number.parseInt(u.value)+100)),s=e.getImageData(0,0,t.width,t.height);n.postMessage({settingsValues:r,controlValues:i,imageData:s})}function j(t,e,a,o){const n=document.createElement("canvas"),r=t.width,i=t.height;let s=0,u=0,l=1920;r>i?(l=Math.min(l,r),s=l,u=i*l/r):(l=Math.min(l,i),u=l,s=r*l/i),n.width=s,n.height=u;const g=n.getContext("2d");g.drawImage(t,0,0,s,u),o.onmessage=L=>{const I=L.data;g.putImageData(I,0,0),M(n)},b(n,g,e,a,o)}function M(t){const e=t.toDataURL("image/jpg"),a=document.createElement("a");a.download="hikari-export.jpg",a.href=e,a.click(),a.remove()}function C(){return new Worker("/hikari/assets/renderWorker.bc2beee3.js",{type:"module"})}const d=document.createElement("canvas"),h=document.createElement("canvas"),y=d.getContext("2d"),E=h.getContext("2d");async function P(t,e){if(e&&e[0]){t.innerHTML="";const a=e[0],o=await N(a);t.appendChild(d);const n=new Image;n.src=o.toString(),n.onload=()=>{const r=U(n.width,n.height);d.setAttribute("width",r.width.toString()),d.setAttribute("height",r.height.toString()),y.drawImage(n,0,0,d.width,d.height),h.setAttribute("width",r.width.toString()),h.setAttribute("height",r.height.toString()),E.drawImage(n,0,0,h.width,h.height),B(t,n)}}}function W(t,e,a,o,n){const r=document.createElement("button");r.textContent="Export",r.onclick=()=>j(e,a,o,n),t.appendChild(r)}function B(t,e){const a={invert:S("Invert",t),bw:S("Black & White",t)},o={brightness:c(-100,100,"Brightness",0,t),contrast:c(-100,100,"Contrast",0,t),saturation:c(-100,100,"Saturation",0,t),redSaturation:c(-100,100,"Red Saturation",0,t),orangeSaturation:c(-100,100,"Orange Saturation",0,t),yellowSaturation:c(-100,100,"Yellow Saturation",0,t),greenSaturation:c(-100,100,"Green Saturation",0,t),tealSaturation:c(-100,100,"Teal Saturation",0,t),cyanSaturation:c(-100,100,"Cyan Saturation",0,t),blueSaturation:c(-100,100,"Blue Saturation",0,t),purpleSaturation:c(-100,100,"Purple Saturation",0,t),magentaSaturation:c(-100,100,"Magenta Saturation",0,t)},n=new C;n.onmessage=s=>{const u=s.data;y.putImageData(u,0,0)};const r=new C,i=p(p({},a),o);W(t,e,a,o,r),Object.values(i).forEach(s=>s.addEventListener("change",()=>b(h,E,a,o,n)))}function N(t){return new Promise((e,a)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=()=>e(o.result?o.result.toString():""),o.onerror=n=>a(n)})}function U(t,e){const a=window.innerHeight*.5,o=window.innerWidth*.5;let n;return t>e?n={width:o,height:o*e/t}:n={width:a*t/e,height:a},n}const x=document.querySelector("#app"),m=document.createElement("input");m.setAttribute("type","file");x.appendChild(m);m.addEventListener("change",()=>{P(x,m.files)});
